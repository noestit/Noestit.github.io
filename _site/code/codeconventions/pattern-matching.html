<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.23.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Pattern matching - Noest docs</title>
<meta name="description" content="This is the document site of Noest.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Noest docs">
<meta property="og:title" content="Pattern matching">
<meta property="og:url" content="http://localhost:4000/code/codeconventions/pattern-matching">


  <meta property="og:description" content="This is the document site of Noest.">












<link rel="canonical" href="http://localhost:4000/code/codeconventions/pattern-matching">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Noest",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Noest docs Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/Block_Logo_Green.png" alt="Noest docs"></a>
        
        <a class="site-title" href="/">
          Noest docs
          <span class="site-subtitle">Code conventions, best practices and configuration files.</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/tooling/index">Tooling</a>
            </li><li class="masthead__menu-item">
              <a href="/documentationtechniques/index">Documentation</a>
            </li><li class="masthead__menu-item">
              <a href="/code/index">Code</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Code Conventions</span>
        

        
        <ul>
          
            <li><a href="/code/codeconventions/conventions">Main</a></li>
          
            <li><a href="/code/codeconventions/best-practices">Best practices</a></li>
          
            <li><a href="/code/codeconventions/entity-framework-linq">EF & Linq</a></li>
          
            <li><a href="/code/codeconventions/logging">Logging</a></li>
          
            <li><a href="/code/codeconventions/pattern-matching" class="active">Pattern matching</a></li>
          
            <li><a href="/code/codeconventions/tdd-unit-testing">TDD unit testing</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Code Guidelines</span>
        

        
        <ul>
          
            <li><a href="/code/codeguidelines/coding-style">Coding Style</a></li>
          
            <li><a href="/code/codeguidelines/folder-structure">Folder structure</a></li>
          
            <li><a href="/code/codeguidelines/globalization">Globalization</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Pattern matching">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Pattern matching
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="pattern-matching">Pattern matching</h2>

<h3 id="is-expression">Is-expression</h3>

<p><a href="csharp7">C# 7</a></p>

<p>An is-expression can now have a pattern, instead of just a type.</p>

<p>The <code class="language-plaintext highlighter-rouge">is</code> and switch statements support pattern matching. The <code class="language-plaintext highlighter-rouge">is</code> keyword supports the following patterns:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">type</code> pattern: tests if an expression can be converted to a specified type. If so it casts to a variable of that type.</li>
</ul>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">obj</span> <span class="k">is</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">"obj is an integer with value {i}"</span><span class="p">);</span>

<span class="c1">// Cast to int via as keyword</span>
<span class="k">if</span><span class="p">(</span><span class="n">obj</span> <span class="k">is</span> <span class="kt">int</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">obj</span> <span class="k">as</span> <span class="kt">int</span><span class="p">;</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">"obj is an integer with value {i}"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">constant</code> pattern: tests if an expression equals a specified constant. This can be a value, a declared const variable or an enumeration constant. Also checking for null is perfomed via constant pattern.</li>
</ul>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">threeDiceHighRoll</span> <span class="p">=</span> <span class="m">18</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="n">diceRoll</span> <span class="k">is</span> <span class="n">threeDiceHighRoll</span> <span class="p">){</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"To the max!"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="n">diceRoll</span> <span class="k">is</span> <span class="m">3</span><span class="p">){</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Triple one"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="n">diceRoll</span> <span class="k">is</span> <span class="k">null</span><span class="p">){</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Did the die land on its corner?"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">var</code> pattern: a match that always succeeds and binds the value of an expression to a new local variable. When the expresion evaluates to null, the is-expression produces true and assigns null to the variable.</li>
</ul>

<p>An example: letâ€™s check if the square sides are a multiple of 2. Since patterns are constant expressions, the modulo calculation is not possible.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="p">{</span> <span class="n">Side</span><span class="p">:</span> <span class="kt">var</span> <span class="n">side</span> <span class="p">}</span> <span class="n">square</span> <span class="p">&amp;&amp;</span> <span class="n">side</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// `sqare` is a Square whose Side is a multiple of 2</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Note:</strong> the <code class="language-plaintext highlighter-rouge">var</code> pattern will always match.</p>

<h3 id="switch-statement">Switch statement</h3>

<p><a href="csharp7">C# 7</a></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">switch</span><span class="p">(</span><span class="n">obj</span><span class="p">){</span>
  <span class="k">case</span> <span class="kt">string</span> <span class="n">text</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">"obj is a string with value {text}"</span><span class="p">);</span>
  <span class="k">case</span> <span class="kt">int</span> <span class="n">number</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">"obj is an integer with value {number}"</span><span class="p">);</span>
  <span class="k">default</span><span class="p">:</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Invalid data"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">When</code> pattern allows you to have additional conditions on the switch case.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">switch</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">case</span> <span class="kt">int</span> <span class="k">value</span> <span class="n">when</span> <span class="k">value</span> <span class="p">&lt;=</span> <span class="m">0</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Less than or equal to 0"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="kt">int</span> <span class="k">value</span> <span class="n">when</span> <span class="k">value</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="k">value</span> <span class="p">&lt;=</span> <span class="m">10</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"More than 0 but less than or equal to 10"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">default</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"More than 10"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">switch</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">case</span> <span class="n">Circle</span> <span class="n">c</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">$"circle with radius </span><span class="p">{</span><span class="n">c</span><span class="p">.</span><span class="n">Radius</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="n">Rectangle</span> <span class="n">s</span> <span class="nf">when</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="n">s</span><span class="p">.</span><span class="n">Height</span><span class="p">):</span> <span class="c1">// This one needs to be above the regular rectangle case, else it will never be hit.</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">$"Square with sides of lenght </span><span class="p">{</span><span class="n">s</span><span class="p">.</span><span class="n">Length</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="n">Rectangle</span> <span class="n">r</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">$"Rectangle with length </span><span class="p">{</span><span class="n">r</span><span class="p">.</span><span class="n">Length</span><span class="p">}</span><span class="s"> and height</span><span class="p">{</span><span class="n">r</span><span class="p">.</span><span class="n">Height</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">default</span><span class="p">:</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Writeline</span><span class="p">(</span><span class="s">"unknown shape"</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="k">null</span><span class="p">:</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">shape</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Note:</strong> the order of case labels is important. Especially with the <code class="language-plaintext highlighter-rouge">with</code> statements.</p>

<h3 id="switch-expression">Switch expression</h3>

<p><a href="csharp8">C# 8</a></p>

<p>There are fewer repetitive keywords, and fewer curly braces needed to write a switch statement.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// classic switch statement</span>
<span class="k">switch</span> <span class="p">(</span><span class="n">color</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="n">Color</span><span class="p">.</span><span class="n">Red</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"The color is red"</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">Color</span><span class="p">.</span><span class="n">Blue</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"The color is blue"</span><span class="p">;</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"The color is unknown."</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// C# 8 switch expression</span>
<span class="k">return</span> <span class="n">color</span> <span class="k">switch</span>
<span class="p">{</span>
    <span class="n">Color</span><span class="p">.</span><span class="n">Red</span> <span class="p">=&gt;</span> <span class="s">"The color is red"</span><span class="p">,</span>
    <span class="n">Color</span><span class="p">.</span><span class="n">Blue</span> <span class="p">=&gt;</span> <span class="s">"The color is blue"</span><span class="p">,</span>
    <span class="n">_</span> <span class="p">=&gt;</span> <span class="s">"The color is unknown."</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div>

<p><strong>Note:</strong> Consider readability when using switch expressions.</p>

<h3 id="property-pattern">Property pattern</h3>

<p><a href="csharp8">C# 8</a>
The <code class="language-plaintext highlighter-rouge">property pattern</code> allows you to match on properties of the examined object.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">isNetDeveloper</span><span class="p">(</span><span class="n">Developer</span> <span class="n">developer</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">developer</span> <span class="k">is</span> <span class="p">{</span> <span class="n">Language</span><span class="p">:</span> <span class="s">".NET"</span> <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You will think you can achieve the same by chaining the properties. <code class="language-plaintext highlighter-rouge">if(developer.Language == ".NET")</code>. Indeed but there will be certain cases where this comes in handy. What if we also want to check the age of the person?</p>

<p>Consider this switch expression. First we use a type pattern to cast it to a <code class="language-plaintext highlighter-rouge">Point</code> (we did it twice) and with the when expression we added additional conditions.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">string</span> <span class="nf">Display</span><span class="p">(</span><span class="kt">object</span> <span class="n">o</span><span class="p">)</span>
    <span class="p">=&gt;</span> <span class="n">o</span> <span class="k">switch</span>
    <span class="p">{</span>
        <span class="n">Point</span> <span class="n">p</span> <span class="n">when</span> <span class="n">p</span><span class="p">.</span><span class="n">X</span> <span class="p">==</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">p</span><span class="p">.</span><span class="n">Y</span> <span class="p">==</span> <span class="m">0</span> <span class="p">=&gt;</span> <span class="s">"origin"</span><span class="p">,</span>
        <span class="n">Point</span> <span class="n">p</span>                           <span class="p">=&gt;</span> <span class="s">$"(</span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="n">X</span><span class="p">}</span><span class="s">, </span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="n">Y</span><span class="p">}</span><span class="s">)"</span><span class="p">,</span>
        <span class="n">_</span>                                 <span class="p">=&gt;</span> <span class="s">"unknown"</span>
    <span class="p">};</span>

<span class="k">static</span> <span class="kt">string</span> <span class="nf">Display</span><span class="p">(</span><span class="kt">object</span> <span class="n">o</span><span class="p">)</span>
    <span class="p">=&gt;</span> <span class="n">o</span> <span class="k">switch</span>
    <span class="p">{</span>
        <span class="n">Point</span> <span class="p">{</span> <span class="n">X</span><span class="p">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span>         <span class="n">p</span> <span class="p">=&gt;</span> <span class="s">"origin"</span><span class="p">,</span>
        <span class="n">Point</span> <span class="p">{</span> <span class="n">X</span><span class="p">:</span> <span class="kt">var</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="kt">var</span> <span class="n">y</span> <span class="p">}</span> <span class="n">p</span> <span class="p">=&gt;</span> <span class="s">$"(</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="s">, </span><span class="p">{</span><span class="n">y</span><span class="p">}</span><span class="s">)"</span><span class="p">,</span>
        <span class="n">_</span>                              <span class="p">=&gt;</span> <span class="s">"unknown"</span>
    <span class="p">};</span>
</code></pre></div></div>

<p>We can even change the â€˜emptyâ€™ property to a compact not-null pattern. The fallback case can be replaced as follows.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{}</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="c1">// checks non-null objects</span>
<span class="k">null</span> <span class="p">=&gt;</span> <span class="s">"null"</span> <span class="c1">// checks for null object</span>
</code></pre></div></div>

<h3 id="positional-patterns">Positional patterns</h3>

<p><a href="csharp8">C# 8</a></p>

<p>Background information.
Object deconstructing makes it possible to extract properties without accessing the properties. You can discard properties you donâ€™t need via <code class="language-plaintext highlighter-rouge">_</code>.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">record</span> <span class="n">Person</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="n">init</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">City</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="n">init</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Deconstruct</span><span class="p">(</span><span class="k">out</span> <span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="k">out</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span>
        <span class="p">=&gt;</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Age</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"John Smith"</span> <span class="p">,</span> <span class="n">Age</span> <span class="p">=</span> <span class="m">25</span> <span class="p">};</span>
<span class="kt">var</span> <span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">=</span> <span class="n">person</span><span class="p">;</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Hello </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s">, looks like you're </span><span class="p">{</span><span class="n">age</span><span class="p">}</span><span class="s"> years old"</span><span class="p">);</span>
</code></pre></div></div>

<p>If an object provides a deconstruct method, we can pattern match the object to match on the properties. It makes it possible to check the type and cast it to the type AND deconstruct it.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">person</span> <span class="k">is</span> <span class="nf">Person</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Person with name </span><span class="p">{</span><span class="n">name</span><span class="p">}</span><span class="s"> is </span><span class="p">{</span><span class="n">age</span><span class="p">}</span><span class="s"> years old"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="n">person</span> <span class="k">is</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="m">65</span><span class="p">)){</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"You used to call me on the landline"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="tuple-patterns">Tuple patterns</h3>

<p><a href="csharp8">C# 8</a></p>

<p>The tuple patterns are a special case of positional patterns. They can be used when we want to match on multiple input values at the same time.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">RockPaperScissors</span><span class="p">(</span><span class="kt">string</span> <span class="n">firstHand</span><span class="p">,</span> <span class="kt">string</span> <span class="n">secondHand</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="p">(</span><span class="n">firstHand</span><span class="p">,</span> <span class="n">secondHand</span><span class="p">)</span> <span class="k">switch</span>
<span class="p">{</span>
    <span class="p">(</span><span class="s">"rock"</span><span class="p">,</span> <span class="s">"paper"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"rock is covered by paper. Paper wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="s">"rock"</span><span class="p">,</span> <span class="s">"scissors"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"rock breaks scissors. Rock wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="s">"paper"</span><span class="p">,</span> <span class="s">"rock"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"paper covers rock. Paper wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="s">"paper"</span><span class="p">,</span> <span class="s">"scissors"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"paper is cut by scissors. Scissors wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="s">"scissors"</span><span class="p">,</span> <span class="s">"rock"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"scissors is broken by rock. Rock wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="s">"scissors"</span><span class="p">,</span> <span class="s">"paper"</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"scissors cuts paper. Scissors wins."</span><span class="p">,</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="s">"tie"</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="pattern-matching-enhancements-c-9">Pattern matching enhancements C# 9</h3>

<h4 id="logical-patterns">Logical patterns</h4>

<p><a href="csharp9">C# 9</a></p>

<p>The logical patterns now can make code unreadable when you start combining multiple checks. In c# 9 we can use the spoken equivalent of these operators. <code class="language-plaintext highlighter-rouge">||</code> becomes <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> becomes <code class="language-plaintext highlighter-rouge">and</code> and <code class="language-plaintext highlighter-rouge">!</code> equals <code class="language-plaintext highlighter-rouge">not</code>;</p>

<p>Via the <code class="language-plaintext highlighter-rouge">not</code> keyword, the negated pattern helps to clarify, among other things, null checks.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">if</span><span class="p">(!(</span><span class="n">language</span> <span class="k">is</span> <span class="k">null</span><span class="p">)){</span>
    <span class="c1">// Do something</span>
<span class="p">}</span>

<span class="c1">// becomes</span>
<span class="k">if</span><span class="p">(</span><span class="n">language</span> <span class="k">is</span> <span class="n">not</span> <span class="k">null</span><span class="p">){</span>
    <span class="c1">// Do something</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">or</code> and <code class="language-plaintext highlighter-rouge">and</code> keywords</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">age</span> <span class="p">=</span> <span class="m">15</span><span class="p">;</span>
<span class="k">if</span> <span class="p">((</span><span class="n">age</span> <span class="p">&gt;=</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">age</span> <span class="p">&lt;=</span> <span class="m">18</span><span class="p">)</span> <span class="p">||</span> <span class="p">(</span><span class="n">age</span> <span class="p">&gt;=</span> <span class="m">65</span> <span class="p">&amp;&amp;</span> <span class="n">age</span> <span class="p">&lt;=</span> <span class="m">9999</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Working age"</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// This will also match the type</span>
<span class="kt">object</span> <span class="n">age</span> <span class="p">=</span> <span class="m">25</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">age</span> <span class="k">is</span> <span class="p">(&gt;=</span> <span class="m">0</span> <span class="n">and</span> <span class="p">&lt;=</span> <span class="m">18</span><span class="p">)</span> <span class="nf">or</span> <span class="p">(&gt;=</span> <span class="m">65</span> <span class="n">and</span> <span class="p">&lt;=</span> <span class="m">9999</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Working age"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Note:</strong> <code class="language-plaintext highlighter-rouge">and</code> and <code class="language-plaintext highlighter-rouge">or</code> pattern are not equivalent to eachother. They cannot be used in the same situations. Below are the variations between both.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">and</code> cannot be placed between two type patterns (unless they are targeting interfaces)</li>
  <li><code class="language-plaintext highlighter-rouge">or</code> can be placed between two type patterns but it doesnâ€™t support capturing (type pattern matching)</li>
  <li><code class="language-plaintext highlighter-rouge">and</code> cannot be placed in a property pattern without a relational one</li>
  <li><code class="language-plaintext highlighter-rouge">or</code> can be placed in a property pattern without a relational one and supports capturing</li>
  <li><code class="language-plaintext highlighter-rouge">or</code> cannot be used between two properties of the same object</li>
  <li><code class="language-plaintext highlighter-rouge">and</code> cannot be used between two properties of the same object, but it is implicit</li>
</ul>

<p>Clarified via code examples:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="n">and</span> <span class="n">Circle</span> <span class="c1">// this will not compile</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="n">or</span> <span class="n">Circle</span> <span class="c1">// OK!</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="n">or</span> <span class="n">Circle</span> <span class="n">smt</span> <span class="c1">// this will not compile</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="p">{</span> <span class="n">Side</span><span class="p">:</span> <span class="m">0</span> <span class="n">and</span> <span class="m">1</span> <span class="p">}</span> <span class="c1">// this will not compile</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Square</span> <span class="p">{</span> <span class="n">Side</span><span class="p">:</span> <span class="m">0</span> <span class="n">or</span> <span class="m">1</span> <span class="p">}</span> <span class="n">sq</span> <span class="c1">// OK!</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Rectangle</span> <span class="p">{</span> <span class="n">Height</span><span class="p">:</span> <span class="m">0</span> <span class="n">or</span> <span class="n">Length</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span> <span class="c1">// this will not compile</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Rectangle</span> <span class="p">{</span> <span class="n">Height</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span> <span class="n">or</span> <span class="n">Rectangle</span> <span class="p">{</span> <span class="n">Length</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span> <span class="c1">// OK!</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Rectangle</span> <span class="p">{</span> <span class="n">Height</span><span class="p">:</span> <span class="m">0</span> <span class="n">and</span> <span class="n">Length</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span> <span class="c1">// this will not compile</span>
<span class="n">shape</span> <span class="k">is</span> <span class="n">Rectangle</span> <span class="p">{</span> <span class="n">Height</span><span class="p">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="m">0</span> <span class="p">}</span> <span class="n">re</span> <span class="c1">// OK! equivalent to the pattern above</span>
</code></pre></div></div>

<h4 id="relational-patterns">Relational patterns</h4>

<p><a href="csharp9">C# 9</a></p>

<p>Relational patterns enables the use of &lt;, &gt;, &gt;=, &lt;= in patterns.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> <span class="kt">int</span> <span class="n">age</span> <span class="n">when</span> <span class="n">age</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">age</span> <span class="p">&lt;=</span> <span class="m">10</span><span class="p">:</span>

<span class="c1">// becomes</span>
<span class="k">case</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="n">and</span> <span class="p">&lt;=</span> <span class="m">10</span><span class="p">:</span>

<span class="c1">// switch expression</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">LifeStage</span> <span class="nf">LifeStageAtAge</span><span class="p">(</span><span class="kt">int</span> <span class="n">age</span><span class="p">)</span>
    <span class="p">=&gt;</span> <span class="n">age</span> <span class="k">switch</span>
    <span class="p">{</span>
        <span class="p">&lt;</span> <span class="m">0</span> <span class="p">=&gt;</span>  <span class="n">LifeStage</span><span class="p">.</span><span class="n">Prenatal</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">2</span> <span class="p">=&gt;</span>  <span class="n">LifeStage</span><span class="p">.</span><span class="n">Infant</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">4</span> <span class="p">=&gt;</span>  <span class="n">LifeStage</span><span class="p">.</span><span class="n">Toddler</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">6</span> <span class="p">=&gt;</span>  <span class="n">LifeStage</span><span class="p">.</span><span class="n">EarlyChild</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">12</span> <span class="p">=&gt;</span> <span class="n">LifeStage</span><span class="p">.</span><span class="n">MiddleChild</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">20</span> <span class="p">=&gt;</span> <span class="n">LifeStage</span><span class="p">.</span><span class="n">Adolescent</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">40</span> <span class="p">=&gt;</span> <span class="n">LifeStage</span><span class="p">.</span><span class="n">EarlyAdult</span><span class="p">,</span>
        <span class="p">&lt;</span> <span class="m">65</span> <span class="p">=&gt;</span> <span class="n">LifeStage</span><span class="p">.</span><span class="n">MiddleAdult</span><span class="p">,</span>
        <span class="n">_</span> <span class="p">=&gt;</span>    <span class="n">LifeStage</span><span class="p">.</span><span class="n">LateAdult</span><span class="p">,</span>
    <span class="p">};</span>
</code></pre></div></div>

<h3 id="wrap-it-up">Wrap it up</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// C# 7 and earlier</span>
<span class="k">if</span> <span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">DateOfBirth</span><span class="p">.</span><span class="n">Year</span> <span class="p">&gt;</span> <span class="m">1970</span> <span class="p">&amp;&amp;</span> <span class="n">person</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">DateOfBirth</span><span class="p">.</span><span class="n">Year</span> <span class="p">&lt;</span> <span class="m">1990</span> <span class="p">&amp;&amp;</span> <span class="n">person</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">LastName</span> <span class="p">==</span> <span class="s">"Smith"</span><span class="p">){}</span>

<span class="c1">// C# 8.0</span>
<span class="k">if</span> <span class="p">(</span><span class="n">person</span> <span class="k">is</span> <span class="p">{</span> <span class="n">Parent</span><span class="p">:</span> <span class="p">{</span> <span class="n">DateOfBirth</span><span class="p">:</span> <span class="p">{</span> <span class="n">Year</span><span class="p">:</span> <span class="kt">var</span> <span class="n">year</span> <span class="p">},</span> <span class="n">LastName</span><span class="p">:</span> <span class="s">"Smith"</span> <span class="p">}</span> <span class="p">}</span> <span class="p">&amp;&amp;</span> <span class="n">year</span> <span class="p">&gt;</span> <span class="m">1970</span> <span class="p">&amp;&amp;</span> <span class="n">year</span> <span class="p">&lt;</span> <span class="m">1990</span><span class="p">){}</span>

<span class="c1">// C# 9 (relational pattern)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">person</span> <span class="k">is</span> <span class="p">{</span> <span class="n">Parent</span><span class="p">:</span> <span class="p">{</span> <span class="n">DateOfBirth</span><span class="p">:</span> <span class="p">{</span> <span class="n">Year</span><span class="p">:</span> <span class="p">&gt;</span> <span class="m">1970</span> <span class="n">and</span> <span class="p">&lt;</span> <span class="m">1990</span> <span class="p">},</span> <span class="n">LastName</span><span class="p">:</span> <span class="s">"Smith"</span> <span class="p">}</span> <span class="p">}){}</span>
</code></pre></div></div>

<p>Used links:
<a href="https://devblogs.microsoft.com/dotnet/do-more-with-patterns-in-c-8-0/">Do more with patterns in #8</a>
<a href="https://renatogolia.com/2020/10/31/pattern-matching-in-c-sharp-9/">Pattern matching in C# 9</a></p>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Noest. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
